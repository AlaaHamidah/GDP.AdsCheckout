<spinner-component [spinnerShow]="isLoading">
  <div class="text-center">
    <i class="fa fa-circle-o-notch fa-spin fa-3x fa-fw"></i>
  </div>
</spinner-component>

<div class="container" *ngIf="!isLoading">
  <div class="col-xs-12">
    <div class="alert alert-danger" *ngIf="!isValid">
      <strong>Error!</strong> You should select at least one item.
    </div>
  </div>
  <div *ngFor="let ad of Ads" class="card">
    <div class="card-block col-xs-12">
      <div class="col-12 col-xs-12 col-sm-12 col-md-6">
        <h4 class="card-title"><strong>{{ad.Name}}</strong></h4>
        <p class="card-text">{{ad.Description}}</p>
        <div class="price">Price {{ad.Price | currency:'USD':'$'}}</div>
      </div>
      <div class="col-12 col-xs-12  col-sm-4 col-md-2 text-center align-middle"><input type="number" class="form-control" min="0" [(ngModel)]="ad.Quantity" /></div>

      <div class="col-12  col-xs-12  col-sm-4 col-md-2 text-center align-middle price">Total {{ad.Price * ad.Quantity | currency:'USD':'$'}}</div>
      <div class="col-12  col-xs-12  col-sm-4 col-md-2 text-center align-middle"><a title="Offer" *ngIf="ad.Offer" (click)="showOfferDetails(ad)">
        <img  src="../assets/images/discount.png" width="35">
      <small>check offer</small></a>
      </div>
    </div>
  </div>
  <div class="row footer">
    <div class="col-xs-12">
      <button class="btn btn-primary pull-right" (click)="checkout()">
        <i class="fa fa-shopping-cart" aria-hidden="true"></i> 
      Check out</button>
    </div>
  </div>

  <!-- Offer Details Dialog -->
  <p-dialog [(visible)]="display" *ngIf="display" [modal]="true" [dismissableMask]="true" [showHeader]="false" [positionTop]="100"
    width="500">
    <img src="../assets/images/discount.png" width="50" class="pull-right">
    <h2 *ngIf="selectedAd.Offer.offerType =='BuyNFreeM'"> Buy {{selectedAd.Offer.minimumPurchase}} Get {{selectedAd.Offer.freeItem}}!</h2>
    <h2 *ngIf="selectedAd.Offer.offerType =='DiscountForN'"> {{ (selectedAd.Price - selectedAd.Offer.newPrice ) | currency:'USD':'$'}} Discount!</h2>

    <h5>
      {{selectedAd.Offer.description}} </h5>
    <div class="btn-row"> <button class="btn btn-grey close-btn" (click)="hideOfferDetails()">Got it!</button></div>
  </p-dialog>



  <!-- Checkout Result Dialog -->
  <p-dialog [(visible)]="displayCheckout" *ngIf="displayCheckout" [modal]="true" [showHeader]="false" [positionTop]="100" width="600">
    <spinner-component [spinnerShow]="isProcessing">
      <div class="text-center">
        <i class="fa fa-circle-o-notch fa-spin fa-3x fa-fw"></i>
      </div>
    </spinner-component>
    <h3>Confirm Your Checkout </h3>
    <table class="table">
      <tbody>
        <tr *ngFor="let item of Ads">
          <th>{{item.Name}} </th>
          <td>x{{item.Quantity}}</td>
          <td>price: {{item.Price | currency:'USD':'$'}}</td>
          <td>total: {{item.Quantity * item.Price | currency:'USD':'$'}}</td>
        </tr>
      </tbody>
    </table>
    <h5>Total : <b>{{checkoutResult.item1 | currency:'USD':'$'}}</b></h5>
    <h5>Total after Discount : <b>{{checkoutResult.item2 | currency:'USD':'$'}}</b></h5>
    <h5> You saved <b>{{checkoutResult.item1 - checkoutResult.item2 | currency:'USD':'$'}}</b></h5>
    <div class="btn-row" style="padding-bottom: 30px"> <button class="btn btn-grey pull-left" (click)="displayCheckout= false ">Close</button>
      <button class="btn btn-success pull-right" (click)="proceed()">Proceed</button>
    </div>

  </p-dialog>
